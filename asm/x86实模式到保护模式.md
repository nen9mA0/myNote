## 编写主引导扇区代码

### 主引导扇区

Main Boot Sector(MBR)  硬盘的**0面0磁道1扇区**

有**512字节，结尾为0x55 0xAA**，BIOS初始化后将其加载到**0000:7c00**执行

### 在屏幕上显示文字

#### 显卡和显存

8086显存地址：**0xB8000~0xBFFFF**，共0x8000字节

一般BIOS加电自检后会初始化图形模式为80\*25

#### 显示字符

在**字符模式**下，一个字符显示占用两个字节，第一个字节为ASCII码，第二个为显示属性

##### 显示属性

1字节

```
  背景色 | 前景色
   4b   |   4b
K R G B | I R G B
```

* K：闪烁位
* I：亮度位

#### 声明并初始化数据

标号 类型 数据

```
data db 0x11, 0x12
```

##### 类型

* db
* dw
* dd
* dq

#### 在末尾加0xAA55

```c
times 510-($-$$) db 0
                 db 0x55,0xaa
```

`$`为当前行的地址，`$$`

## 相同的功能不同的代码

### 处理器标志位

```
15 14 13 12 11 10  9  8  7  6  5  4  3  2  1  0
  |  |  |  |OF|DF|IF|TF|SF|ZF|  |AF|  |PF|  |CF
```

* OF  overflow
* DF  direct
* IF  中断允许
* TF  调试标志位
* SF  sign  符号
* ZF  zero
* AF  辅助进位（最后四位向前进位
* PF  奇偶
* CF  进位

### 数据传送指令

`DS:SI -> ES:DI`

movsb movsw

#### rep

加上rep前缀后执行CX次

#### DF标志

* DF=0  每次rep后DI/SI +1
* DF=1  每次rep后DI/SI -1

std置1，cld清零