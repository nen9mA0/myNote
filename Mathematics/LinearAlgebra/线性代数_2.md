## 矩阵的秩与线性方程组

### 矩阵的秩

#### 子矩阵

在`m*n`矩阵A中，任意取k行l列，选取交叉处元素组成的矩**行列式**称为A的`k*l`子矩阵。当k=l，称为矩阵A的一个**k阶子式**

如
$$
A = \begin{pmatrix}
1 & 2 & 3 & 4 \\
5 & 6 & 7 & 8 \\
9 & 10 & 11 & 12
\end{pmatrix}
$$
选取1 2 3行和1 2 4列组成的一个3阶子式为
$$
A = \begin{vmatrix}
1 & 2 & 4 \\
5 & 6 & 8 \\
9 & 10 & 12
\end{vmatrix}
$$

#### 秩

##### 定义

若A中有一个**不为0的**r阶子式D，且所有的r+1阶子式全为0，那么D称为A的一个**最高阶非零子式**，r为矩阵的秩，记作R(A)。**零矩阵的秩为0**

* 若矩阵A有一个r阶子式不为0，则R(A)>=r。若所有r+1阶子式全为0，则R(A)<=r
* 若B是A的子矩阵，则$R(B) \leq R(A)$

##### 满秩矩阵与降秩矩阵

若A是n阶方阵，则n阶子式只有一个|A|，则

* 若$|A| \neq 0$，R(A) = n，称为满秩矩阵
* |A|=0，R(A)<n，称为降秩矩阵

#####  初等变换

初等变换不改变矩阵的秩

因此可以将矩阵化为行阶梯矩阵，从而直接求得矩阵的秩

##### 性质

* $0 \leq R(A_{m \times n}) \leq min\{m,n\}$
* $R(A)=R(A^T)$
* 若P Q可逆，$R(PA) = R(AQ) = R(PAQ)$
* $max\{R(A), R(B)\} \leq R(A,B) \leq R(A) + R(B)$
* $R(A+B) \leq R(A,B) \leq R(A) + R(B)$
* A B是`m*n`和`n*s`矩阵，$R(AB) \leq min\{R(A), R(B)\}$
* A B是`m*n`和`n*s`矩阵，$R(AB) \geq R(A) + R(B) - n$  **西尔维斯特（Sylvester）不等式**
* A B是`m*n`和`n*s`矩阵，$R(A) + R(B) \leq n$

### 线性方程组解的判定

#### 几个结论

对于n元线性方程组 Ax=b，$\tilde A$为增广矩阵(A b)

* 有解的充要条件为 $R(\tilde A) = R(A)$
* 有唯一解的充要条件为 $R(A) = R(\tilde A) = n$
* 有无穷多解的充要条件为 $R(A) = R(\tilde A) < n$

因此对于n元齐次线性方程组 Ax=0，有非零解的充要条件是 $R(A) < n$

* 矩阵方程 $AX=B$ 有解的充要条件是 $R(A) = R(A,B)$

### 分块矩阵的初等变换

#### 分块初等变换

与矩阵初等变换相似，分别为

* 互换分块矩阵的行/列
* 用一个可逆矩阵左乘/右乘分块矩阵的某一行/列
* 把分块矩阵某一行/列左乘/右乘一个矩阵后加到另一行/列

#### 分块单位矩阵

形如下式的矩阵
$$
\begin{pmatrix}
E_m & O \\
O & E_n
\end{pmatrix}
$$

#### 分块初等矩阵

对分块单位矩阵做**一次**分块初等变换后得到的矩阵

对分块矩阵做一次初等变换相当于用一个分块初等矩阵左乘/右乘该矩阵

##### 性质

* 分块初等矩阵可逆
* 若分块矩阵A经过有限次初等变换变为B，则两矩阵等价
* 分块初等变换不改变矩阵的秩

#### 分块初等矩阵的秩

设A为`m*n`矩阵，B为`s*t`矩阵，C为`m*t`矩阵

* 定理1
  $$
  R(\begin{pmatrix} A & C \\ O & B \end{pmatrix}) \geq R(A) + R(B)
  $$
  
* 定理2
  $$
  R(\begin{pmatrix} A & O \\ O & B \end{pmatrix}) = R(A) + R(B)
  $$

* 弗罗贝尼乌斯不等式

  设A为`m*n`矩阵 B为`n*s`矩阵 C为`s*t`矩阵
  $$
  R(AB) + R(BC) \leq R(B) + R(ABC)
  $$
  将A B C换为X(`m*n`) E(`n*n`) Y(`n*p`)得西尔维斯特不等式
  $$
  R(X) + R(Y) \leq n + R(XY)
  $$
  将A B C换为X Y O和X Y O，分别得$R(XY) \leq R(Y)$和$R(XY) \leq R(X)$，即上面性质中的不等式
  $$
  R(AB) \leq min\{R(A), R(B)\}
  $$

## 向量空间

### 向量

#### 矩阵的向量分解

$\boldsymbol \alpha_i$表示**列向量**，$\boldsymbol \beta_i$表示**行向量**，
$$
\boldsymbol A =
\begin{pmatrix}
\boldsymbol \alpha_1 & \boldsymbol \alpha_2 & \cdots & \boldsymbol \alpha_n
\end{pmatrix}
=
\begin{pmatrix}
\boldsymbol \beta_1 \\ \boldsymbol \beta_2 \\ \vdots \\ \boldsymbol \beta_n
\end{pmatrix}
$$

#### 方程组的向量表示

AX=B可以表示为
$$
x_1 \boldsymbol \alpha_1 + x_2 \boldsymbol \alpha_2 + \cdots + x_n \boldsymbol \alpha_n = \boldsymbol \beta
$$

### 向量组的线性相关性

#### 线性组合

设$\boldsymbol \alpha_1, \boldsymbol \alpha_2, \cdots , \boldsymbol \alpha_m, \boldsymbol \beta$是n维向量，若存在一组数$k_1, k_2, \cdots , k_m$，使得
$$
\boldsymbol \beta = k_1 \boldsymbol \alpha_1 + k_2 \boldsymbol \alpha_2 + \cdots + k_m \boldsymbol \alpha_m
$$
则称向量$\boldsymbol \beta$是向量组$\boldsymbol \alpha_1, \boldsymbol \alpha_2, \cdots , \boldsymbol \alpha_m$的**线性组合**，$\boldsymbol \beta$可由$\boldsymbol \alpha_1, \boldsymbol \alpha_2, \cdots , \boldsymbol \alpha_m$**线性表示**

##### 充要条件

$\boldsymbol \beta$可由$\boldsymbol \alpha_1, \boldsymbol \alpha_2, \cdots , \boldsymbol \alpha_m$**线性表示**  等价于

线性方程组$\boldsymbol \beta = x_1 \boldsymbol \alpha_1 + x_2 \boldsymbol \alpha_2 + \cdots + x_m \boldsymbol \alpha_m$有解  等价于

矩阵$\boldsymbol A = \begin{pmatrix} \boldsymbol \alpha_1, \boldsymbol \alpha_2, \cdots , \boldsymbol \alpha_m \end{pmatrix}$与增广矩阵$\tilde{\boldsymbol A} = \begin{pmatrix} \boldsymbol \alpha_1, \boldsymbol \alpha_2, \cdots , \boldsymbol \alpha_m, \boldsymbol \beta \end{pmatrix}$的秩相等

##### 唯一线性表示

由上面可知，要使线性表示唯一，必有
$$
R(\boldsymbol A) = R(\tilde{\boldsymbol A}) = m
$$

#### 线性相关性

设$\boldsymbol \alpha_1, \boldsymbol \alpha_2, \cdots , \boldsymbol \alpha_m$是n维向量，若存在一组**不全为0**的数$k_1, k_2, \cdots , k_m$，使得
$$
k_1 \boldsymbol \alpha_1 + k_2 \boldsymbol \alpha_2 + \cdots + k_m \boldsymbol \alpha_m = \boldsymbol 0
$$
则称向量组**线性相关**，否则为**线性无关**

#### 充要条件



## 相似矩阵

### 方阵的特征值和特征向量

#### 定义

设A是n阶方阵，如果存在**数**$\lambda$和n维非零列向量x，使得
$$
Ax = \lambda x
$$
则称数$\lambda$为矩阵A的**特征值**，非零列向量x称为矩阵A的属于特征值$\lambda$的**特征向量**

**注意**：零向量不能作为特征向量，但特征值可以为0。所以降秩矩阵必有特征值0，因为降秩矩阵R(A)<n，|A|=0，所以齐次线性方程组$Ax = 0$存在非零解a，所以$Aa = 0a$，

#### 特征方程与特征多项式

##### 定义

$$
(A - \lambda E) x = 0
$$

这里将方程化为了一个齐次线性方程，因此若有$\lambda$使得x有非零解，则数$\lambda$是A的一个特征值。由齐次线性方程组有非零解的充要条件可知
$$
|\lambda E - A| = 0
$$
展开得
$$
\begin{aligned}
|\lambda E - A| &= B = 
\begin{pmatrix}
\lambda - a_{11} & -a_{12} & \cdots & -a_{1n} \\
-a_{21} & \lambda - a_{22} & \cdots & -a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
-a_{n1} & a_{n2} & \cdots & \lambda - a_{nn} \\
\end{pmatrix}
\\
~
\\
&= (\lambda-a_{11}) B_{11} + -a_{12} B_{12} + \cdots + -a_{1n} B_{1n}
\\
~
\\
&= \lambda^n + a_1 \lambda^{n-1} + \cdots + a_{n-1} \lambda + a_n
\end{aligned}
$$
称$|\lambda E - A|$为A的**特征多项式**，方程$|\lambda E - A|=0$为**特征方程**

由特征多项式可知，特征多项式可以有n个根，若$\lambda$为A的单根，则称其为A的**单特征值**。若$\lambda$为A的k重根，则称其为A的**k重特征值**，k为$\lambda$的**代数重数**

##### 解法

* 计算特征多项式$\lambda E - A$
* 求$|\lambda E - A| = 0$的所有根$\lambda_1, \lambda_2, \cdots , \lambda_n$，即A的全部特征值
* 对每个特征值$\lambda_i$求齐次线性方程组$(\lambda_i E - A) x = 0$的一个基础解系

## 一些问题的解释和证明

### 矩阵的秩

#### 初等变换

设A经过初等变换后变为B，R(A)=r，D是B的任意r+1阶子式，|D|=0

证明$R(A) \geq R(B)$

##### 交换r

交换i1,i2行

* 若D本身不含i1和i2行，显然|D|不变

* 若D既含i1又含i2行，显然|D|还是不变（相当于行列式内的初等变换）

* 若D含i1不含i2，则因为对于A来说，必有r+1阶子式D2与D相同

  例如D由B的第1 2 3行和第4 5 6列构成，A到B的变换为交换了第4列和第9列，则D相当于A的由1 2 3行和5 6 9列构成的子式。由于该子式仍是A的r+1阶子式，因此|D|=0

##### kr

显然对于|D|=0，某行乘常数不改变结果

#####r+kr

$r_i + k r_j$

* D不含第i行，显然无影响，|D|=0

* D含i和j行，相当于行列式内初等变换，|D|=0

* D含i行不含j行，则如下，显然分解出的两个行列式都是A的r+1阶子式，所以|D|=0
  $$
  D = \begin{vmatrix}
  \vdots \\
  r_i + k r_j \\
  \vdots
  \end{vmatrix}
  =
  \begin{vmatrix}
  \vdots \\
  r_i \\
  \vdots
  \end{vmatrix}
  + k
  \begin{vmatrix}
  \vdots \\
  r_j \\
  \vdots
  \end{vmatrix}
  $$

上述过程可以证明$R(A) \geq R(B)$，因为初等变换可逆，因此也有$R(A) \leq R(B)$，综上，$R(A) = R(B)$

##### 推论

因为A乘所有可逆矩阵都可视作初等变换，因此对于可逆矩阵P Q，有
$$
R(A) = R(PA) = R(AQ) = R(PAQ)
$$

#### 性质

##### 几个不等式

设A是`m*n`矩阵，B是`n*s`矩阵

* $max\{R(A), R(B)\} \leq R(A,B) \leq R(A) + R(B)$

  * $max\{R(A), R(B)\} \leq R(A,B)$  因为A，B的所有非零子式均为(A,B)的非零子式，所以必有

  * $R(A,B) \leq R(A) + R(B)$  因为对于A必存在一个P，使得其与行阶梯型矩阵U有关系$A = P_1U_1$，对于B同样。而由矩阵的秩的定义可得，$R(A) = R(U_1)$，因此
    $$
    R(A,B) = R(
    \begin{pmatrix} P_1 & P_2 \end{pmatrix}
    \begin{pmatrix} U_1 & O \\ O & U_2\end{pmatrix})
    =
    R(\begin{pmatrix} U_1 & O \\ O & U_2\end{pmatrix})
    \leq R(U_1) + R(U_2) = R(A) + R(B)
    $$

* $R(A+B) \leq R(A) + R(B)$

  将(A+B)组合为分块矩阵(A+B B)，假设A B均为n阶矩阵，则使1~n列减去n+1~2n列，有(A+B B)=(A B)，因此
  $$
  R(A+B) \leq R(\begin{pmatrix} A+B & B \end{pmatrix}) =  R(\begin{pmatrix} A & B \end{pmatrix})\leq R(A) + R(B)
  $$

* $R(AB) \leq min \{ R(A),R(B) \}$

  因为$\begin{pmatrix} A & AB \end{pmatrix} = \begin{pmatrix} A & O \end{pmatrix}  \begin{pmatrix} E_n & B \\ O & E_s \end{pmatrix}$，又因为$\begin{vmatrix} E_n & B \\ O & E_s \end{vmatrix}\neq 0 $，所以为可逆矩阵，由性质3，若P可逆，则`R(AP) = R(A)`，即
  $$
  R(\begin{pmatrix} A & AB \end{pmatrix}) = R(\begin{pmatrix} A & O \end{pmatrix}  \begin{pmatrix} E_n & B \\ O & E_s \end{pmatrix}) = R(\begin{pmatrix} A & O \end{pmatrix}) = R(A)
  $$
  又因为AB是(A AB)的子矩阵，因此$R(AB) \leq R(\begin{pmatrix} A & AB \end{pmatrix})$，综上，$R(AB) \leq R(A)$

##### 西尔维斯特不等式

$R(AB) \geq R(A) + R(B) - n$

将B分解为行最简式，有
$$
\begin{aligned}
B &= P \begin{pmatrix} E_r & O \\ O & O \end{pmatrix} Q
\end{aligned}
$$
令
$$
AB = A P \begin{pmatrix} E_r & O \\ O & O \end{pmatrix} Q = \begin{pmatrix} P_1 & P_2\end{pmatrix}\begin{pmatrix} E_r & O \\ O & O \end{pmatrix} Q = \begin{pmatrix} P_1 & O \end{pmatrix} Q
$$
所以
$$
R(AB) = R(\begin{pmatrix} P_1 & O \end{pmatrix} Q) = R(\begin{pmatrix} P_1 & O \end{pmatrix}) = R(P_1)
$$
由上面的分析，因为B为`n*s`矩阵，因为这里的P Q都是可逆矩阵，所以P为`n*n`矩阵，Q为`s*s`矩阵

因为A为`m*n`矩阵，所以AP为`m*n`矩阵，则P1为`m*r`矩阵，P2为`m*(n-r)`矩阵

由性质1，$R(P_2) \leq min\{m, n-r\}$，所以必有$R(P_2) \leq n-r$

则
$$
R(A) = R(AP) = R(\begin{pmatrix} P_1 & P_2\end{pmatrix}) \leq R(P_1) + R(P_2) = R(P_1) + n - r
$$
所以
$$
R(P_1) \geq R(A) + r - n
$$
由B的分解式得，R(B) = r，所以
$$
R(AB) = R(P_1) \geq R(A) + r - n = R(A) + R(B) - n
$$
得证

#### 线性方程组解的判定

##### n元线性方程组

对于增广矩阵$\tilde A = \begin{pmatrix} A & b\end{pmatrix}$，必可化为行阶梯型矩阵。设其化为下列行阶梯型矩阵
$$
\begin{pmatrix}
1 & 0 & \cdots & 0 & b_{1r+1} & \cdots & b_{1n} & d_1 \\
0 & 1 & \cdots & 0 & b_{2r+1} & \cdots & b_{2n} & d_2 \\
\vdots & \vdots & & \vdots & \vdots &  & \vdots & \vdots \\
0 & 0 & \cdots & 1 & b_{rr+1} & \cdots & b_{rn} & d_r \\
0 & 0 & \cdots & 0 & 0 & \cdots & 0 & d_{r+1} \\
\vdots & \vdots & & \vdots & \vdots &  & \vdots & \vdots \\
0 & 0 & \cdots & 0 & 0 & \cdots & 0 & 0 
\end{pmatrix}
$$
则结果为
$$
\left \{
\begin{aligned}
x_1 + b_{1r+1}x_{r+1} + \cdots b_{1n}x_{n} &= d_1 \\
x_2 + b_{2r+1}x_{r+1} + \cdots b_{2n}x_{n} &= d_2 \\
\cdots \\
x_r + b_{rr+1}x_{r+1} + \cdots b_{rn}x_{n} &= d_r \\
0 & = d_{r+1}
\end{aligned}
\right.
$$
则若$d_{r+1} \neq 0$，则原方程组无解。所以当$R(A) \neq R(\tilde A)$时，原方程无解

若r=n，即增广矩阵没有零行，则
$$
\left \{
\begin{aligned}
x_1 &= d_1 \\
x_2 &= d_2 \\
\cdots \\
x_n &= d_n
\end{aligned}
\right .
$$
若r<n，则
$$
\left \{
\begin{aligned}
x_1 + b_{1r+1}x_{r+1} + \cdots + b_{1n}x_{n} &= d_1 \\
x_2 + b_{2r+1}x_{r+1} + \cdots + b_{2n}x_{n} &= d_2 \\
\cdots \\
x_r + b_{rr+1}x_{r+1} + \cdots + b_{rn}x_{n} &= d_r \\
\end{aligned}
\right .
$$
即
$$
\left \{
\begin{aligned}
x_1 &= d_1 - b_{1r+1}x_{r+1} - \cdots - b_{1n}x_{n} \\
x_2 &= d_2 - b_{2r+1}x_{r+1} - \cdots - b_{2n}x_{n} \\
\cdots \\
x_r &= d_r - b_{rr+1}x_{r+1} - \cdots - b_{rn}x_{n} \\
\end{aligned}
\right .
$$

##### 推论

矩阵方程 $AX=B$ 有解的充要条件是 $R(A) = R(A,B)$

##### n元齐次线性方程组

增广矩阵为(A, 0)

若r=n，则可以初等变换化为
$$
\begin{pmatrix}
1 & 0 & \cdots & 0 & 0 \\
0 & 1 & \cdots & 0 & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \cdots & 1 & 0
\end{pmatrix}
$$
即方程可化为
$$
\left \{
\begin{aligned}
x_1 &  &&= 0 \\
& x_2 &  &= 0 \\
\cdots \\
&  & x_r &= 0 \\
\end{aligned}
\right .
$$
因此对于n元齐次线性方程组，r<n时才有非零解

#### 分块矩阵的秩

##### 定理1 2

$$
R(\begin{pmatrix} A & O \\ O & B \end{pmatrix}) = R(A) + R(B)
$$

设R(A)=r，R(B)=s，则
$$
R(\begin{pmatrix} A & O \\ O & B \end{pmatrix}) =
R(\begin{pmatrix}
E_r & O & O & O \\
O & O & O & O \\
O & O & E_s & O \\
O & O & O & O\end{pmatrix})
=
R(\begin{pmatrix}
E_r & O & O & O \\
O & E_s & O & O \\
O & O & O & O \\
O & O & O & O\end{pmatrix})
=
R(A) + R(B)
$$
由上面的证明，可以直观地证明第一个不等式
$$
R(\begin{pmatrix} A & C \\ O & B \end{pmatrix}) = R(A) + R(B)
$$
因为若C的秩大于A的秩，显然分块矩阵的秩大于$R(\begin{pmatrix} A & O \\ O & B \end{pmatrix})$

##### 弗罗贝尼乌斯不等式

$$
R(AB) + R(BC) \leq R(B) + R(ABC)
$$

因为
$$
\begin{pmatrix}
B & O \\
O & ABC
\end{pmatrix}
\overset{r_2 + Ar_1}=
\begin{pmatrix}
B & O \\
AB & ABC
\end{pmatrix}
\overset{c_2-Cc_1}=
\begin{pmatrix}
B & -BC \\
AB & O
\end{pmatrix}
\overset{-c_2}=
\begin{pmatrix}
B & BC \\
AB & O
\end{pmatrix}
=
\begin{pmatrix}
AB & O \\
B & BC
\end{pmatrix}
$$
所以
$$
R(B) + R(ABC) = 
R(\begin{pmatrix}
B & O \\
O & ABC
\end{pmatrix})
=
R(\begin{pmatrix}
AB & O \\
B & BC
\end{pmatrix})
\geq 
R(AB) + R(BC)
$$


