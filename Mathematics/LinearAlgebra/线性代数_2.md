## 矩阵的秩与线性方程组

### 矩阵的秩

#### 子矩阵

在`m*n`矩阵A中，任意取k行l列，选取交叉处元素组成的矩**行列式**称为A的`k*l`子矩阵。当k=l，称为矩阵A的一个**k阶子式**

如
$$
A = \begin{bmatrix}
1 & 2 & 3 & 4 \\
5 & 6 & 7 & 8 \\
9 & 10 & 11 & 12
\end{bmatrix}
$$
选取1 2 3行和1 2 4列组成的一个3阶子式为
$$
A = \begin{vmatrix}
1 & 2 & 4 \\
5 & 6 & 8 \\
9 & 10 & 12
\end{vmatrix}
$$

#### 秩

##### 定义

若A中有一个**不为0的**r阶子式D，且所有的r+1阶子式全为0，那么D称为A的一个**最高阶非零子式**，r为矩阵的秩，记作R(A)。**零矩阵的秩为0**

* 若矩阵A有一个r阶子式不为0，则R(A)>=r。若所有r+1阶子式全为0，则R(A)<=r
* 若B是A的子矩阵，则$R(B) \leq R(A)$

##### 满秩矩阵与降秩矩阵

若A是n阶方阵，则n阶子式只有一个|A|，则

* 若$|A| \neq 0$，R(A) = n，称为满秩矩阵
* |A|=0，R(A)<n，称为降秩矩阵

#####  初等变换

初等变换不改变矩阵的秩

因此可以将矩阵化为行阶梯矩阵，从而直接求得矩阵的秩

##### 性质

* $0 \leq R(A_{m \times n}) \leq min\{m,n\}$
* $R(A)=R(A^T)$
* 若P Q可逆，$R(PA) = R(AQ) = R(PAQ)$
* $max\{R(A), R(B)\} \leq R(A,B) \leq R(A) + R(B)$
* $R(A+B) \leq R(A) + R(B)$
* A B是`m*n`和`n*s`矩阵，$R(AB) \leq min\{R(A), R(B)\}$
* A B是`m*n`和`n*s`矩阵，$R(AB) \geq R(A) + R(B) - n$  **西尔维斯特（Sylvester）不等式**
* A B是`m*n`和`n*s`矩阵，$R(A) + R(B) \leq n$

### 线性方程组解的判定

#### 几个结论

对于n元线性方程组 Ax=b，$\tilde A$为增广矩阵(A b)

* 有解的充要条件为 $R(\tilde A) = R(A)$
* 有唯一解的充要条件为 $R(A) = R(\tilde A) = n$
* 有无穷多解的充要条件为 $R(A) = R(\tilde A) < n$

因此对于n元齐次线性方程组 Ax=0，有非零解的充要条件是 $R(A) < n$

* 矩阵方程 $AX=B$ 有解的充要条件是 $R(A) = R(A,B)$

### 分块矩阵的初等变换

#### 分块初等变换

与矩阵初等变换相似，分别为

* 互换分块矩阵的行/列
* 用一个可逆矩阵左乘/右乘分块矩阵的某一行/列
* 把分块矩阵某一行/列左乘/右乘一个矩阵后加到另一行/列

#### 分块单位矩阵

形如下式的矩阵
$$
\begin{bmatrix}
E_m & O \\
O & E_n
\end{bmatrix}
$$

#### 分块初等矩阵

对分块单位矩阵做**一次**分块初等变换后得到的矩阵

对分块矩阵做一次初等变换相当于用一个分块初等矩阵左乘/右乘该矩阵

##### 性质

* 分块初等矩阵可逆
* 若分块矩阵A经过有限次初等变换变为B，则两矩阵等价
* 分块初等变换不改变矩阵的秩

## 一些问题的解释和证明

### 矩阵的秩

#### 初等变换

设A经过初等变换后变为B，R(A)=r，D是B的任意r+1阶子式，|D|=0

证明$R(A) \geq R(B)$

##### 交换r

交换i1,i2行

* 若D本身不含i1和i2行，显然|D|不变

* 若D既含i1又含i2行，显然|D|还是不变（相当于行列式内的初等变换）

* 若D含i1不含i2，则因为对于A来说，必有r+1阶子式D2与D相同

  例如D由B的第1 2 3行和第4 5 6列构成，A到B的变换为交换了第4列和第9列，则D相当于A的由1 2 3行和5 6 9列构成的子式。由于该子式仍是A的r+1阶子式，因此|D|=0

##### kr

显然对于|D|=0，某行乘常数不改变结果

#####r+kr

$r_i + k r_j$

* D不含第i行，显然无影响，|D|=0

* D含i和j行，相当于行列式内初等变换，|D|=0

* D含i行不含j行，则如下，显然分解出的两个行列式都是A的r+1阶子式，所以|D|=0
  $$
  D = \begin{vmatrix}
  \vdots \\
  r_i + k r_j \\
  \vdots
  \end{vmatrix}
  =
  \begin{vmatrix}
  \vdots \\
  r_i \\
  \vdots
  \end{vmatrix}
  + k
  \begin{vmatrix}
  \vdots \\
  r_j \\
  \vdots
  \end{vmatrix}
  $$

上述过程可以证明$R(A) \geq R(B)$，因为初等变换可逆，因此也有$R(A) \leq R(B)$，综上，$R(A) = R(B)$

##### 推论

因为A乘所有可逆矩阵都可视作初等变换，因此对于可逆矩阵P Q，有
$$
R(A) = R(PA) = R(AQ) = R(PAQ)
$$

#### 性质

##### 几个不等式

设A是`m*n`矩阵，B是`n*s`矩阵

* $max\{R(A), R(B)\} \leq R(A,B) \leq R(A) + R(B)$

  * $max\{R(A), R(B)\} \leq R(A,B)$  因为A，B的所有非零子式均为(A,B)的非零子式，所以必有

  * $R(A,B) \leq R(A) + R(B)$  因为对于A必存在一个P，使得其与行阶梯型矩阵U有关系$A = P_1U_1$，对于B同样。而由矩阵的秩的定义可得，$R(A) = R(U_1)$，因此
    $$
    R(A,B) = R(
    \begin{bmatrix} P_1 & P_2 \end{bmatrix}
    \begin{bmatrix} U_1 & O \\ O & U_2\end{bmatrix})
    =
    R(\begin{bmatrix} U_1 & O \\ O & U_2\end{bmatrix})
    \leq R(U_1) + R(U_2) = R(A) + R(B)
    $$

* $R(A+B) \leq R(A) + R(B)$

  将(A+B)组合为分块矩阵(A+B B)，假设A B均为n阶矩阵，则使1~n列减去n+1~2n列，有(A+B B)=(A B)，因此
  $$
  R(A+B) = R(\begin{bmatrix} A & B \end{bmatrix})\leq R(A) + R(B)
  $$

* $R(AB) \leq min \{ R(A),R(B) \}$

  因为$\begin{bmatrix} A & AB \end{bmatrix} = \begin{bmatrix} A & O \end{bmatrix}  \begin{bmatrix} E_n & B \\ O & E_s \end{bmatrix}$，又因为$\begin{vmatrix} E_n & B \\ O & E_s \end{vmatrix}\neq 0 $，所以为可逆矩阵，由性质3，若P可逆，则`R(AP) = R(A)`，即
  $$
  R(\begin{bmatrix} A & AB \end{bmatrix}) = R(\begin{bmatrix} A & O \end{bmatrix}  \begin{bmatrix} E_n & B \\ O & E_s \end{bmatrix}) = R(\begin{bmatrix} A & O \end{bmatrix}) = R(A)
  $$
  又因为AB是(A AB)的子矩阵，因此$R(AB) \leq R(\begin{bmatrix} A & AB \end{bmatrix})$，综上，$R(AB) \leq R(A)$

##### 西尔维斯特不等式

$R(AB) \geq R(A) + R(B) - n$

将B分解为行最简式，有
$$
\begin{aligned}
B &= P \begin{bmatrix} E_r & O \\ O & O \end{bmatrix} Q
\end{aligned}
$$
令
$$
AB = A P \begin{bmatrix} E_r & O \\ O & O \end{bmatrix} Q = \begin{bmatrix} P_1 & P_2\end{bmatrix}\begin{bmatrix} E_r & O \\ O & O \end{bmatrix} Q = \begin{bmatrix} P_1 & O \end{bmatrix} Q
$$
所以
$$
R(AB) = R(\begin{bmatrix} P_1 & O \end{bmatrix} Q) = R(\begin{bmatrix} P_1 & O \end{bmatrix}) = R(P_1)
$$
由上面的分析，因为B为`n*s`矩阵，因为这里的P Q都是可逆矩阵，所以P为`n*n`矩阵，Q为`s*s`矩阵

因为A为`m*n`矩阵，所以AP为`m*n`矩阵，则P1为`m*r`矩阵，P2为`m*(n-r)`矩阵

由性质1，$R(P_2) \leq min\{m, n-r\}$，所以必有$R(P_2) \leq n-r$

则
$$
R(A) = R(AP) = R(\begin{bmatrix} P_1 & P_2\end{bmatrix}) \leq R(P_1) + R(P_2) = R(P_1) + n - r
$$
所以
$$
R(P_1) \geq R(A) + r - n
$$
由B的分解式得，R(B) = r，所以
$$
R(AB) = R(P_1) \geq R(A) + r - n = R(A) + R(B) - n
$$
得证

#### 线性方程组解的判定

对于增广矩阵$\tilde A = \begin{bmatrix} A & b\end{bmatrix}$，必可化为行阶梯型矩阵。设其化为下列行阶梯型矩阵
$$
\begin{bmatrix}
1 & 0 & \cdots & 0 & b_{1r+1} & \cdots & b_{1n} & d_1 \\
0 & 1 & \cdots & 0 & b_{2r+1} & \cdots & b_{2n} & d_2 \\
\vdots & \vdots & & \vdots & \vdots &  & \vdots & \vdots \\
0 & 0 & \cdots & 1 & b_{rr+1} & \cdots & b_{rn} & d_r \\
0 & 0 & \cdots & 0 & 0 & \cdots & 0 & d_{r+1} \\
\vdots & \vdots & & \vdots & \vdots &  & \vdots & \vdots \\
0 & 0 & \cdots & 0 & 0 & \cdots & 0 & 0 
\end{bmatrix}
$$
则结果为
$$
\left \{
\begin{aligned}
x_1 + b_{1r+1}x_{r+1} + \cdots b_{1n}x_{n} &= d_1 \\
x_2 + b_{2r+1}x_{r+1} + \cdots b_{2n}x_{n} &= d_2 \\
\cdots \\
x_r + b_{rr+1}x_{r+1} + \cdots b_{rn}x_{n} &= d_r \\
0 & = d_{r+1}
\end{aligned}
\right.
$$
则若$d_{r+1} \neq 0$，则原方程组无解。所以当$R(A) \neq R(\tilde A)$时，原方程无解

若r=n，即增广矩阵没有零行，则
$$
\left \{
\begin{aligned}
x_1 &= d_1 \\
x_2 &= d_2 \\
\cdots \\
x_n &= d_n
\end{aligned}
\right .
$$
若r<n，则
$$
\left \{
\begin{aligned}
x_1 + b_{1r+1}x_{r+1} + \cdots + b_{1n}x_{n} &= d_1 \\
x_2 + b_{2r+1}x_{r+1} + \cdots + b_{2n}x_{n} &= d_2 \\
\cdots \\
x_r + b_{rr+1}x_{r+1} + \cdots + b_{rn}x_{n} &= d_r \\
\end{aligned}
\right .
$$
即
$$
\left \{
\begin{aligned}
x_1 &= d_1 - b_{1r+1}x_{r+1} - \cdots - b_{1n}x_{n} \\
x_2 &= d_2 - b_{2r+1}x_{r+1} - \cdots - b_{2n}x_{n} \\
\cdots \\
x_r &= d_r - b_{rr+1}x_{r+1} - \cdots - b_{rn}x_{n} \\
\end{aligned}
\right .
$$

##### 推论

矩阵方程 $AX=B$ 有解的充要条件是 $R(A) = R(A,B)$

